import{r as l,j as e,S as O,f as z,p as P}from"./index-DYi0Vkv2.js";function W({id:i,nombre_completo:d,estudio_id:c,dniCapitan:f,emailCapitan:b,telefonoCapitan:N,esCapitan:m,onRemove:S,onSetCapitan:v,isCapitanDisabled:w,errores:a,estudios:u,numeroJugador:g,onJugadorChange:y}){const[J,C]=l.useState(!1),[k,A]=l.useState(d||""),[I,_]=l.useState(c||""),[D,E]=l.useState(f||""),[q,F]=l.useState(b||""),[T,p]=l.useState(N||""),x=(n,h)=>{h!=null&&(n==="nombre_completo"&&A(h),n==="estudio_id"&&_(h),n==="dni"&&E(h),n==="email"&&F(h),n==="telefono"&&p(h),y(i,n,h))},$=()=>{C(!0),setTimeout(()=>{S(i)},300)};return e.jsx("div",{className:`labelJugador d-flex justify-content-flex align-items-center pe-3 mb-4 h-100 ${J?"fade-out":""}`,children:e.jsxs("div",{className:"card p-3 bg-light col-11 w-100",id:`jugador-${i}`,children:[e.jsxs("div",{className:"tituloJugador w-100 bg-primary py-2 px-3 text-white rounded d-flex align-items-center justify-content-between",children:[e.jsxs("h5",{className:"",children:["Jugador ",g]}),e.jsxs("div",{className:"form-check form-switch d-flex align-items-center",children:[e.jsx("input",{className:"form-check-input me-2",type:"checkbox",role:"switch",id:`capitan-${i}`,checked:m,onChange:()=>v(i,!m),disabled:w}),e.jsx("label",{className:"form-check-label",htmlFor:`capitan-${i}`,children:"Capitán"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Nombre Completo: *"}),e.jsx("input",{type:"text",className:"form-control",name:"nombre_completo",value:k,onChange:n=>x("nombre_completo",n.target.value)}),(a==null?void 0:a.nombre_completo)&&e.jsx("span",{className:"text-danger small",children:a.nombre_completo})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Estudio: *"}),e.jsxs("select",{className:"form-select",name:"estudio_id",value:I,onChange:n=>x("estudio_id",n.target.value),children:[e.jsx("option",{value:"",children:"Selecciona un estudio"}),u.map(n=>e.jsxs("option",{value:n.id,children:[n.ciclo," - Curso ",n.curso]},n.id))]}),(a==null?void 0:a.estudio_id)&&e.jsx("span",{className:"text-danger small",children:a.estudio_id})]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"DNI: *"}),e.jsx("input",{type:"text",className:"form-control",name:"dni",value:D,onChange:n=>x("dni",n.target.value)}),(a==null?void 0:a.dni)&&e.jsx("span",{className:"text-danger small",children:a.dni})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Email: *"}),e.jsx("input",{type:"email",className:"form-control",name:"email",value:q,onChange:n=>x("email",n.target.value)}),(a==null?void 0:a.email)&&e.jsx("span",{className:"text-danger small",children:a.email})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Teléfono: *"}),e.jsx("input",{type:"tel",className:"form-control",name:"telefono",value:T,onChange:n=>x("telefono",n.target.value)}),(a==null?void 0:a.telefono)&&e.jsx("span",{className:"text-danger small",children:a.telefono})]})]}),e.jsx("div",{className:"eliminar mt-4 d-flex justify-content-center",children:e.jsx("i",{className:"bi bi-trash text-danger fs-4",style:{cursor:"pointer"},onClick:$})})]})})}function G({titulo:i,id:d,children:c}){const[f,b]=l.useState({});l.useEffect(()=>{b(m=>({...m,[d]:!0}))},[d]);const N=()=>{b(m=>({...m,[d]:!m[d]}))};return e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header bg-primary text-white",onClick:N,style:{cursor:"pointer"},children:i}),f[d]&&e.jsx("div",{className:"card-body",children:c})]})}function H(){const[i,d]=l.useState(null),[c,f]=l.useState({}),[b,N]=l.useState([]),[m,S]=l.useState([]),[v,w]=l.useState(0),a=l.useId(),[u,g]=l.useState(null),[y,J]=l.useState(""),[C,k]=l.useState(""),A=t=>{J(t.target.value)},I=t=>{k(t.target.value)},[_,D]=l.useState(""),[E,q]=l.useState(""),F=t=>{D(t.target.value)},T=t=>{q(t.target.value)},[p,x]=l.useState([]),$=(t,s,o)=>{const r=p.map(j=>j.id===t?{...j,[s]:o}:j);x(r)};p.find(t=>t.id===i);const n=()=>{const t=`${a}-${v}`;x([...p,{id:t,nombre_completo:"",estudio_id:""}]),w(v+1)},h=t=>{const s=p.filter(o=>o.id!==t);i===t&&d(null),x(s)},M=t=>{d(i===t?null:t)},R=t=>{const s=[];return Object.keys(t).forEach(o=>{if(o.startsWith("jugadores.")){const r=o.match(/^jugadores\.(\d+)\.(\w+)/);if(r){const j=parseInt(r[1]),L=r[2];s[j]||(s[j]={}),s[j][L]=t[o][0]}}}),s},U=async t=>{t.preventDefault();const s={nombre:y,centro_id:C,entrenador_nombre_completo:_,entrenador_email:E,jugadores:p.map(r=>({nombre_completo:r.nombre_completo,estudio_id:r.estudio_id,dni:r.id===i?r.dni:null,email:r.id===i?r.email:null,telefono:r.id===i?r.telefono:null,capitan:r.id===i?1:0}))},o=await P("equipos",s);o.error?o.status===422?o.data&&o.data.errors&&f(o.data.errors):console.error("Error no manejado:",o):(alert("Formulario enviado correctamente"),f({}))};if(l.useEffect(()=>{(async()=>{try{const s=await z("estudios");s.status==="success"&&N(s.estudios);const o=await z("centros");o.status==="success"&&S(o.centros)}catch(s){console.error("Error al obtener los datos:",s)}})()},[]),!b.length)return e.jsx(O,{});const B=R(c);return e.jsxs("div",{className:"contenedor-inscripcion container bg-light border rounded p-5",children:[e.jsx("h2",{className:"text-center",children:"Inscribe a tu Equipo"}),e.jsxs("div",{className:"row d-flex justify-content-between mb-4",children:[e.jsxs("div",{className:"tarjeta card mb-3 text-center d-flex justify-content-center align-items-center mt-5",onClick:()=>g("equipo"),style:{cursor:"pointer"},children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"130",height:"130",fill:"currentColor",className:"bi bi-people-fill",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5.784 6A2.24 2.24 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.3 6.3 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1zM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"})})}),e.jsx("div",{className:"card-body",children:e.jsx("h5",{className:"card-title",children:"Equipo"})})]}),e.jsxs("div",{className:"tarjeta card mb-3 text-center d-flex justify-content-center align-items-center mt-5",onClick:()=>g("entrenador"),style:{cursor:"pointer"},children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("img",{src:"https://img.icons8.com/ios-filled/100/personal-trainer.png",alt:"personal-trainer"})}),e.jsx("div",{className:"card-body",children:e.jsx("h5",{className:"card-title",children:"Entrenador"})})]}),e.jsxs("div",{className:"tarjeta card mb-3 text-center d-flex justify-content-center align-items-center mt-5",onClick:()=>g("jugadores"),style:{cursor:"pointer"},children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("img",{src:"https://img.icons8.com/ios-filled/100/groups.png",alt:"groups"})}),e.jsx("div",{className:"card-body",children:e.jsx("h5",{className:"card-title",children:"Jugadores"})})]})]}),u&&e.jsxs(G,{titulo:u.charAt(0).toUpperCase()+u.slice(1),activo:u,setActivo:g,id:u,children:[u==="equipo"&&e.jsxs("div",{className:"mb-1 p-3",children:[e.jsx("label",{children:"Nombre del Equipo: *"}),e.jsx("input",{type:"text",className:"form-control mb-1",name:"nombre",value:y,onChange:A}),c.nombre&&c.nombre.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s)),e.jsx("label",{children:"Centro: *"}),e.jsxs("select",{className:"form-select mb-1",name:"centro",value:C,onChange:I,children:[e.jsx("option",{value:"",hidden:!0,children:"Selecciona un centro"}),Array.isArray(m)&&m.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]}),c.centro_id&&c.centro_id.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s))]}),u==="entrenador"&&e.jsxs("div",{className:"mb-1 p-3",children:[e.jsx("label",{children:"Nombre Completo: *"}),e.jsx("input",{type:"text",className:"form-control mb-1",name:"entrenador_nombre_completo",value:_,onChange:F}),c.entrenador_nombre_completo&&c.entrenador_nombre_completo.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s)),e.jsx("label",{children:"Email: *"}),e.jsx("input",{type:"email",className:"form-control mb-1",name:"entrenador_email",value:E,onChange:T}),c.entrenador_email&&c.entrenador_email.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s))]}),u==="jugadores"&&e.jsxs("div",{children:[e.jsxs("button",{className:"botonAñadir btn btn-primary mt-2 mb-4",onClick:n,children:[e.jsx("i",{className:"bi bi-plus-circle-fill m-2"}),"Añadir Jugador"]}),e.jsxs("div",{className:"d-flex flex-wrap justify-content-between",children:[p.map((t,s)=>e.jsx(W,{id:t.id,nombre_completo:t.nombre_completo,dni:t.dni||"",email:t.email||"",telefono:t.telefono||"",estudio_id:t.estudio_id,esCapitan:i===t.id,onRemove:h,onSetCapitan:M,isCapitanDisabled:i!==null&&i!==t.id,errores:B[s]||{},estudios:b,numeroJugador:s+1,onJugadorChange:$},t.id)),c.jugadores&&Array.isArray(c.jugadores)&&c.jugadores.map((t,s)=>e.jsx("span",{className:"text-danger small d-block",children:t},s))]})]})]}),e.jsxs("button",{className:"botonEnviar btn btn-success mt-3",onClick:U,children:[e.jsx("i",{className:"bi bi-send-fill m-2"}),"Enviar"]})]})}function Q(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"Formulario de inscripción"}),e.jsx(H,{})]})}export{Q as default};
