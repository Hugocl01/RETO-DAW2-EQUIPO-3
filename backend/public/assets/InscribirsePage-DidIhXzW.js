import{r as i,j as e,S as O,f as z,p as P}from"./index-D8IbmME8.js";function W({id:o,nombre_completo:r,estudio_id:c,dniCapitan:j,emailCapitan:p,telefonoCapitan:g,esCapitan:d,onRemove:S,onSetCapitan:v,isCapitanDisabled:w,errores:l,estudios:m,numeroJugador:f,onJugadorChange:y}){const[J,C]=i.useState(!1),[k,A]=i.useState(r||""),[I,_]=i.useState(c||""),[D,E]=i.useState(j||""),[q,F]=i.useState(p||""),[T,x]=i.useState(g||""),h=(a,u)=>{u!=null&&(a==="nombre_completo"&&A(u),a==="estudio_id"&&_(u),a==="dni"&&E(u),a==="email"&&F(u),a==="telefono"&&x(u),y(o,a,u))},$=()=>{C(!0),setTimeout(()=>{S(o)},300)};return e.jsx("div",{className:`labelJugador d-flex justify-content-flex align-items-center pe-3 mb-4 h-100 ${J?"fade-out":""}`,children:e.jsxs("div",{className:"card p-3 bg-light col-11 w-100",id:`jugador-${o}`,children:[e.jsxs("div",{className:"tituloJugador w-100 bg-primary py-2 px-3 text-white rounded d-flex align-items-center justify-content-between",children:[e.jsxs("h5",{className:"",children:["Jugador ",f]}),e.jsxs("div",{className:"form-check form-switch d-flex align-items-center",children:[e.jsx("input",{className:"form-check-input me-2",type:"checkbox",role:"switch",id:`capitan-${o}`,checked:d,onChange:()=>v(o,!d),disabled:w}),e.jsx("label",{className:"form-check-label",htmlFor:`capitan-${o}`,children:"Capitán"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Nombre Completo: *"}),e.jsx("input",{type:"text",className:"form-control",name:"nombre_completo",value:k,onChange:a=>h("nombre_completo",a.target.value)}),(l==null?void 0:l.nombre_completo)&&e.jsx("span",{className:"text-danger small",children:l.nombre_completo})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Estudio: *"}),e.jsxs("select",{className:"form-select",name:"estudio_id",value:I,onChange:a=>h("estudio_id",a.target.value),children:[e.jsx("option",{value:"",children:"Selecciona un estudio"}),m.map(a=>e.jsxs("option",{value:a.id,children:[a.ciclo," - Curso ",a.curso]},a.id))]}),(l==null?void 0:l.estudio_id)&&e.jsx("span",{className:"text-danger small",children:l.estudio_id})]}),d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"DNI: *"}),e.jsx("input",{type:"text",className:"form-control",name:"dni",value:D,onChange:a=>h("dni",a.target.value)}),(l==null?void 0:l.dni)&&e.jsx("span",{className:"text-danger small",children:l.dni})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Email: *"}),e.jsx("input",{type:"email",className:"form-control",name:"email",value:q,onChange:a=>h("email",a.target.value)}),(l==null?void 0:l.email)&&e.jsx("span",{className:"text-danger small",children:l.email})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{children:"Teléfono: *"}),e.jsx("input",{type:"tel",className:"form-control",name:"telefono",value:T,onChange:a=>h("telefono",a.target.value)}),(l==null?void 0:l.telefono)&&e.jsx("span",{className:"text-danger small",children:l.telefono})]})]}),e.jsx("div",{className:"eliminar mt-4 d-flex justify-content-center",children:e.jsx("i",{className:"bi bi-trash text-danger fs-4",style:{cursor:"pointer"},onClick:$})})]})})}function G({titulo:o,id:r,children:c}){const[j,p]=i.useState({});i.useEffect(()=>{p(d=>({...d,[r]:!0}))},[r]);const g=()=>{p(d=>({...d,[r]:!d[r]}))};return e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header bg-primary text-white",onClick:g,style:{cursor:"pointer"},children:o}),j[r]&&e.jsx("div",{className:"card-body",children:c})]})}function H(){const[o,r]=i.useState(null),[c,j]=i.useState({}),[p,g]=i.useState([]),[d,S]=i.useState([]),[v,w]=i.useState(0),l=i.useId(),[m,f]=i.useState(null),[y,J]=i.useState(""),[C,k]=i.useState(""),A=t=>{J(t.target.value)},I=t=>{k(t.target.value)},[_,D]=i.useState(""),[E,q]=i.useState(""),F=t=>{D(t.target.value)},T=t=>{q(t.target.value)},[x,h]=i.useState([]),$=(t,s,n)=>{const N=x.map(b=>b.id===t?{...b,[s]:n}:b);h(N)};x.find(t=>t.id===o);const a=()=>{const t=`${l}-${v}`;h([...x,{id:t,nombre_completo:"",estudio_id:""}]),w(v+1)},u=t=>{const s=x.filter(n=>n.id!==t);o===t&&r(null),h(s)},M=t=>{r(o===t?null:t)},R=t=>{const s=[];return Object.keys(t).forEach(n=>{if(n.startsWith("jugadores.")){const N=n.match(/^jugadores\.(\d+)\.(\w+)/);if(N){const b=parseInt(N[1]),L=N[2];s[b]||(s[b]={}),s[b][L]=t[n][0]}}}),s},U=async t=>{t.preventDefault();const s={nombre:y,centro_id:C,entrenador_nombre_completo:_,entrenador_email:E,jugadores:x.map(n=>({nombre_completo:n.nombre_completo,estudio_id:n.estudio_id,dni:n.id===o?n.dni:null,email:n.id===o?n.email:null,telefono:n.id===o?n.telefono:null,capitan:n.id===o?1:0}))};try{const n=await P("equipos",s);alert("Formulario enviado correctamente"),j({})}catch(n){console.error("Error al enviar el formulario",n),n.response&&n.response.status===422&&j(n.response.data.errors)}};if(i.useEffect(()=>{(async()=>{try{const s=await z("estudios");s.status==="success"&&g(s.estudios);const n=await z("centros");n.status==="success"&&S(n.centros)}catch(s){console.error("Error al obtener los datos:",s)}})()},[]),!p.length)return e.jsx(O,{});const B=R(c);return e.jsxs("div",{className:"contenedor-inscripcion container bg-light border rounded p-5",children:[e.jsx("h2",{className:"text-center",children:"Inscribe a tu Equipo"}),e.jsxs("div",{className:"row d-flex justify-content-between mb-4",children:[e.jsxs("div",{className:"tarjeta card mb-3 text-center d-flex justify-content-center align-items-center mt-5",onClick:()=>f("equipo"),style:{cursor:"pointer"},children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"130",height:"130",fill:"currentColor",className:"bi bi-people-fill",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5.784 6A2.24 2.24 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.3 6.3 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1zM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"})})}),e.jsx("div",{className:"card-body",children:e.jsx("h5",{className:"card-title",children:"Equipo"})})]}),e.jsxs("div",{className:"tarjeta card mb-3 text-center d-flex justify-content-center align-items-center mt-5",onClick:()=>f("entrenador"),style:{cursor:"pointer"},children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("img",{src:"https://img.icons8.com/ios-filled/100/personal-trainer.png",alt:"personal-trainer"})}),e.jsx("div",{className:"card-body",children:e.jsx("h5",{className:"card-title",children:"Entrenador"})})]}),e.jsxs("div",{className:"tarjeta card mb-3 text-center d-flex justify-content-center align-items-center mt-5",onClick:()=>f("jugadores"),style:{cursor:"pointer"},children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("img",{src:"https://img.icons8.com/ios-filled/100/groups.png",alt:"groups"})}),e.jsx("div",{className:"card-body",children:e.jsx("h5",{className:"card-title",children:"Jugadores"})})]})]}),m&&e.jsxs(G,{titulo:m.charAt(0).toUpperCase()+m.slice(1),activo:m,setActivo:f,id:m,children:[m==="equipo"&&e.jsxs("div",{className:"mb-1 p-3",children:[e.jsx("label",{children:"Nombre del Equipo: *"}),e.jsx("input",{type:"text",className:"form-control mb-1",name:"nombre",value:y,onChange:A}),c.nombre&&c.nombre.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s)),e.jsx("label",{children:"Centro: *"}),e.jsxs("select",{className:"form-select mb-1",name:"centro",value:C,onChange:I,children:[e.jsx("option",{value:"",hidden:!0,children:"Selecciona un centro"}),Array.isArray(d)&&d.map(t=>e.jsx("option",{value:t.id,children:t.nombre},t.id))]}),c.centro_id&&c.centro_id.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s))]}),m==="entrenador"&&e.jsxs("div",{className:"mb-1 p-3",children:[e.jsx("label",{children:"Nombre Completo: *"}),e.jsx("input",{type:"text",className:"form-control mb-1",name:"entrenador_nombre_completo",value:_,onChange:F}),c.entrenador_nombre_completo&&c.entrenador_nombre_completo.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s)),e.jsx("label",{children:"Email: *"}),e.jsx("input",{type:"email",className:"form-control mb-1",name:"entrenador_email",value:E,onChange:T}),c.entrenador_email&&c.entrenador_email.map((t,s)=>e.jsx("small",{className:"text-danger d-block",children:t},s))]}),m==="jugadores"&&e.jsxs("div",{children:[e.jsxs("button",{className:"botonAñadir btn btn-primary mt-2 mb-4",onClick:a,children:[e.jsx("i",{className:"bi bi-plus-circle-fill m-2"}),"Añadir Jugador"]}),e.jsxs("div",{className:"d-flex flex-wrap justify-content-between",children:[x.map((t,s)=>e.jsx(W,{id:t.id,nombre_completo:t.nombre_completo,dni:t.dni||"",email:t.email||"",telefono:t.telefono||"",estudio_id:t.estudio_id,esCapitan:o===t.id,onRemove:u,onSetCapitan:M,isCapitanDisabled:o!==null&&o!==t.id,errores:B[s]||{},estudios:p,numeroJugador:s+1,onJugadorChange:$},t.id)),c.jugadores&&Array.isArray(c.jugadores)&&c.jugadores.map((t,s)=>e.jsx("span",{className:"text-danger small d-block",children:t},s))]})]})]}),e.jsxs("button",{className:"botonEnviar btn btn-success mt-3",onClick:U,children:[e.jsx("i",{className:"bi bi-send-fill m-2"}),"Enviar"]})]})}function Q(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"Formulario de inscripción"}),e.jsx(H,{})]})}export{Q as default};
