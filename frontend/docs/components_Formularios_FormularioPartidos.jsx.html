<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Formularios/FormularioPartidos.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Formularios/FormularioPartidos.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useState, useEffect } from "react";
import llamadas from "../../data/FuncionesCombobox";

/**
 * Función para obtener la lista de incidencias desde la API.
 *
 * @async
 * @function fetchIncidencias
 * @returns {Promise&lt;Array>} Lista de incidencias con formato { value, label }.
 */
const fetchIncidencias = async () => {
    try {
        // Si no hay datos en sessionStorage, los obtenemos de la API
        console.log("Cargando incidencias desde la API...");
        const data = await llamadas().incidencias();

        if (!data) return []; // Si hubo un error en la API, devolvemos un array vacío

        return Object.keys(data).map(key => ({
            value: key,
            label: data[key]
        }));

    } catch (error) {
        console.error("Error al obtener las incidencias", error);
        return [];
    }
};

/**
 * Componente para gestionar un formulario de partidos.
 * Permite registrar incidencias durante un partido, como goles, tarjetas, etc.
 *
 * @component
 * @param {Object} props - Propiedades del componente.
 * @param {Object} props.datosIniciales - Datos iniciales para el formulario.
 * @param {Function} props.onGuardar - Función para manejar el envío del formulario.
 * @param {Function} props.onCancelar - Función para manejar la cancelación del formulario.
 * @returns {JSX.Element} Componente de formulario de partidos.
 */
function FormularioPartidos({ datosIniciales, onGuardar, onCancelar }) {
    const [equipoSeleccionado, setEquipoSeleccionado] = useState("");
    const [jugadores, setJugadores] = useState([]);
    const [equipoLocal, setEquipoLocal] = useState(datosIniciales["equipo local"].nombre);
    const [equipoVisitante, setEquipoVisitante] = useState(datosIniciales["equipo visitante"].nombre);
    const [incidencias, setIncidencias] = useState([]);
    const [minuto, setMinuto] = useState("");  // Nuevo estado para el minuto
    const [comentario, setComentario] = useState("");  // Nuevo estado para el comentario
    const [jugadorSeleccionado, setJugadorSeleccionado] = useState("");
    const [incidenciaSeleccionada, setIncidenciaSeleccionada] = useState("");

    // Efecto para cargar las incidencias al montar el componente
    useEffect(() => {
        const cargarIncidencias = async () => {
            const data = await fetchIncidencias();
            console.log("Incidencias cargadas:", data);
            setIncidencias(data);
        };
        cargarIncidencias();
    }, []);

    // Efecto para cargar los jugadores del equipo seleccionado
    useEffect(() => {
        if (equipoSeleccionado) {
            const jugadoresEquipo = datosIniciales["equipo local"].nombre === equipoSeleccionado
                ? datosIniciales["equipo local"].Jugadores
                : datosIniciales["equipo visitante"].Jugadores;
            setJugadores(jugadoresEquipo);
        }
    }, [equipoSeleccionado, datosIniciales]);

    // Deshabilitar el botón de guardar si no se han completado todos los campos
    const deshabilitarGuardar = !equipoSeleccionado || !jugadorSeleccionado || !incidenciaSeleccionada || !minuto || !comentario;

    return (
        &lt;div className="p-4 bg-white rounded-lg shadow-md">
            {/* Tablas de Actas */}
            &lt;div className="d-flex justify-content-between">
                {/* Tabla Equipo Local */}
                &lt;div className="w-50">
                    &lt;h3 className="text-lg font-bold mb-2 text-center">Actas - {equipoLocal}&lt;/h3>
                    &lt;table className="w-full mx-auto border">
                        &lt;thead>
                            &lt;tr className="bg-gray-200">
                                &lt;th className="border p-2">Jugador&lt;/th>
                                &lt;th className="border p-2">Incidencia&lt;/th>
                                &lt;th className="border p-2">Minuto&lt;/th>
                            &lt;/tr>
                        &lt;/thead>
                        &lt;tbody>
                            {datosIniciales.actas.filter(acta => acta.equipo === equipoLocal).map((acta) => (
                                &lt;tr key={acta.id} className="border">
                                    &lt;td className="border p-2">{acta.jugador || "-"}&lt;/td>
                                    &lt;td className="border p-2">{acta.incidencia}&lt;/td>
                                    &lt;td className="border p-2">{acta.minuto}&lt;/td>
                                &lt;/tr>
                            ))}
                        &lt;/tbody>
                    &lt;/table>
                &lt;/div>
                {/* Tabla Equipo Visitante */}
                &lt;div className="w-50">
                    &lt;h3 className="text-lg font-bold mb-2 text-center">Actas - {equipoVisitante}&lt;/h3>
                    &lt;table className="w-full mx-auto border">
                        &lt;thead>
                            &lt;tr className="bg-gray-200">
                                &lt;th className="border p-2">Jugador&lt;/th>
                                &lt;th className="border p-2">Incidencia&lt;/th>
                                &lt;th className="border p-2">Minuto&lt;/th>
                            &lt;/tr>
                        &lt;/thead>
                        &lt;tbody>
                            {datosIniciales.actas.filter(acta => acta.equipo === equipoVisitante).map((acta) => (
                                &lt;tr key={acta.id} className="border">
                                    &lt;td className="border p-2">{acta.jugador || "-"}&lt;/td>
                                    &lt;td className="border p-2">{acta.incidencia}&lt;/td>
                                    &lt;td className="border p-2">{acta.minuto}&lt;/td>
                                &lt;/tr>
                            ))}
                        &lt;/tbody>
                    &lt;/table>
                &lt;/div>
            &lt;/div>

            {/* Selección de Equipo */}
            &lt;div className="mb-4">
                &lt;label className="block font-semibold mb-2">Seleccionar Equipo&lt;/label>
                &lt;div className="flex space-x-4">
                    &lt;label className="flex items-center">
                        &lt;input
                            type="radio"
                            name="equipo"
                            value={equipoLocal}
                            checked={equipoSeleccionado === equipoLocal}
                            onChange={(e) => setEquipoSeleccionado(e.target.value)}
                            className="mr-2"
                        />
                        {equipoLocal}
                    &lt;/label>
                    &lt;label className="flex items-center">
                        &lt;input
                            type="radio"
                            name="equipo"
                            value={equipoVisitante}
                            checked={equipoSeleccionado === equipoVisitante}
                            onChange={(e) => setEquipoSeleccionado(e.target.value)}
                            className="mr-2"
                        />
                        {equipoVisitante}
                    &lt;/label>
                &lt;/div>
            &lt;/div>

            {/* Selección de Jugador */}
            &lt;div className="mb-4">
                &lt;label className="block font-semibold mb-2">Seleccionar Jugador&lt;/label>
                &lt;select
                    className="w-full p-2 border rounded"
                    disabled={!equipoSeleccionado}
                    onChange={(e) => setJugadorSeleccionado(e.target.value)}
                >
                    &lt;option value="" hidden>Seleccione un jugador&lt;/option>
                    {jugadores.map((jugador) => (
                        &lt;option key={jugador.id} value={jugador.nombre}>{jugador.nombre}&lt;/option>
                    ))}
                &lt;/select>
            &lt;/div>

            {/* Selección de Incidencia */}
            &lt;div className="mb-4">
                &lt;label className="block font-semibold mb-2">Seleccionar Incidencia&lt;/label>
                &lt;select
                    className="w-full p-2 border rounded"
                    onChange={(e) => setIncidenciaSeleccionada(e.target.value)}
                >
                    &lt;option value="" hidden>Seleccione una incidencia&lt;/option>
                    {incidencias.length > 0 ? (
                        incidencias.map((incidencia, index) => (
                            &lt;option key={index} value={incidencia.value}>{incidencia.label}&lt;/option>
                        ))
                    ) : (
                        &lt;option disabled>Cargando...&lt;/option>
                    )}
                &lt;/select>
            &lt;/div>

            {/* Minuto */}
            &lt;div className="mb-4">
                &lt;label className="block font-semibold mb-2">Minuto&lt;/label>
                &lt;input
                    type="number"
                    className="w-full p-2 border rounded"
                    value={minuto}
                    onChange={(e) => setMinuto(e.target.value)}
                    min="1"
                    max="90"
                    required
                />
            &lt;/div>

            {/* Comentario */}
            &lt;div className="mb-4">
                &lt;label className="block font-semibold mb-2">Comentario&lt;/label>
                &lt;textarea
                    className="w-full p-2 border rounded"
                    value={comentario}
                    onChange={(e) => setComentario(e.target.value)}
                    rows="4"
                    placeholder="Escribe un comentario sobre la incidencia"
                    required
                />
            &lt;/div>

            {/* Botones de Acción */}
            &lt;div className="flex justify-between">
                &lt;button
                    type="button"
                    onClick={onGuardar}
                    disabled={deshabilitarGuardar}
                    className="px-4 py-2 bg-blue-500 text-white rounded"
                >
                    Guardar
                &lt;/button>
                &lt;button
                    type="button"
                    onClick={onCancelar}
                    className="px-4 py-2 bg-gray-300 rounded"
                >
                    Cancelar
                &lt;/button>
            &lt;/div>
        &lt;/div>
    );
}

export default FormularioPartidos;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#AppEnrutador">AppEnrutador</a></li><li><a href="global.html#AppLayout">AppLayout</a></li><li><a href="global.html#BaseLayout">BaseLayout</a></li><li><a href="global.html#Carousel">Carousel</a></li><li><a href="global.html#Clasificacion">Clasificacion</a></li><li><a href="global.html#CrudCentros">CrudCentros</a></li><li><a href="global.html#CrudCiclos">CrudCiclos</a></li><li><a href="global.html#CrudEquipos">CrudEquipos</a></li><li><a href="global.html#CrudEstudios">CrudEstudios</a></li><li><a href="global.html#CrudFamilias">CrudFamilias</a></li><li><a href="global.html#CrudImagenes">CrudImagenes</a></li><li><a href="global.html#CrudInscripciones">CrudInscripciones</a></li><li><a href="global.html#CrudJugadores">CrudJugadores</a></li><li><a href="global.html#CrudPartidos">CrudPartidos</a></li><li><a href="global.html#CrudPatrocinadores">CrudPatrocinadores</a></li><li><a href="global.html#CrudPublicaciones">CrudPublicaciones</a></li><li><a href="global.html#CrudRetos">CrudRetos</a></li><li><a href="global.html#CrudTorneos">CrudTorneos</a></li><li><a href="global.html#CrudUsuarios">CrudUsuarios</a></li><li><a href="global.html#CuadroClasificacion">CuadroClasificacion</a></li><li><a href="global.html#DetalleEstadisticaPage">DetalleEstadisticaPage</a></li><li><a href="global.html#Equipo">Equipo</a></li><li><a href="global.html#EquiposPage">EquiposPage</a></li><li><a href="global.html#ErrorPage">ErrorPage</a></li><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#FormularioCentros">FormularioCentros</a></li><li><a href="global.html#FormularioCiclos">FormularioCiclos</a></li><li><a href="global.html#FormularioEquipos">FormularioEquipos</a></li><li><a href="global.html#FormularioEstudios">FormularioEstudios</a></li><li><a href="global.html#FormularioFamilias">FormularioFamilias</a></li><li><a href="global.html#FormularioJugadores">FormularioJugadores</a></li><li><a href="global.html#FormularioPartidos">FormularioPartidos</a></li><li><a href="global.html#FormularioPatrocinadores">FormularioPatrocinadores</a></li><li><a href="global.html#FormularioPublicaciones">FormularioPublicaciones</a></li><li><a href="global.html#FormularioRetos">FormularioRetos</a></li><li><a href="global.html#FormularioUsuarios">FormularioUsuarios</a></li><li><a href="global.html#Galeria">Galeria</a></li><li><a href="global.html#GaleriaPage">GaleriaPage</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#InfoTorneo">InfoTorneo</a></li><li><a href="global.html#Inicio">Inicio</a></li><li><a href="global.html#InicioPage">InicioPage</a></li><li><a href="global.html#Inscribirse">Inscribirse</a></li><li><a href="global.html#InscribirsePage">InscribirsePage</a></li><li><a href="global.html#Jugador">Jugador</a></li><li><a href="global.html#JugadorLabel">JugadorLabel</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#LoginPage">LoginPage</a></li><li><a href="global.html#MenuAdministracion">MenuAdministracion</a></li><li><a href="global.html#Migas">Migas</a></li><li><a href="global.html#OrganizacionPage">OrganizacionPage</a></li><li><a href="global.html#Paginador">Paginador</a></li><li><a href="global.html#Paginator">Paginator</a></li><li><a href="global.html#Partido">Partido</a></li><li><a href="global.html#Partidos">Partidos</a></li><li><a href="global.html#PartidosPage">PartidosPage</a></li><li><a href="global.html#PerfilPage">PerfilPage</a></li><li><a href="global.html#Retos">Retos</a></li><li><a href="global.html#RutaPrivada">RutaPrivada</a></li><li><a href="global.html#SeguridadContext">SeguridadContext</a></li><li><a href="global.html#SeguridadProvider">SeguridadProvider</a></li><li><a href="global.html#Spinner">Spinner</a></li><li><a href="global.html#TablaEquipos">TablaEquipos</a></li><li><a href="global.html#TablaJugadores">TablaJugadores</a></li><li><a href="global.html#TablaPartidos">TablaPartidos</a></li><li><a href="global.html#TarjetaFormulario">TarjetaFormulario</a></li><li><a href="global.html#TorneoPage">TorneoPage</a></li><li><a href="global.html#YouTubeLiveIndicator">YouTubeLiveIndicator</a></li><li><a href="global.html#cargarOpciones">cargarOpciones</a></li><li><a href="global.html#fetchCentros">fetchCentros</a></li><li><a href="global.html#fetchCiclos">fetchCiclos</a></li><li><a href="global.html#fetchData">fetchData</a></li><li><a href="global.html#fetchEquipos">fetchEquipos</a></li><li><a href="global.html#fetchEstudios">fetchEstudios</a></li><li><a href="global.html#fetchFamilias">fetchFamilias</a></li><li><a href="global.html#fetchIncidencias">fetchIncidencias</a></li><li><a href="global.html#fetchTiposPerfil">fetchTiposPerfil</a></li><li><a href="global.html#generateSlug">generateSlug</a></li><li><a href="global.html#subirImagen">subirImagen</a></li><li><a href="global.html#useCrud">useCrud</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Mar 06 2025 00:41:31 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
